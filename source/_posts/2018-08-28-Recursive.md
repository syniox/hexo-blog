---
title: 常系数齐次线性递推
date: 2018-08-28
category: Note
tag: [数论,DP/优化]
---


>现在有一个数列$a$,并满足以下性质：  
$a_ n=a_ n-1 \times x$（x为常数）  
那么我们可以轻易地写出$a$的通项公式：$a_ n=x^ n$  
现在有一个兔子数列：  
$a_ n=a_ {n-1}+ a_ {n-2}$  
是否能够找到一种表示方法，使得$a_ n=x^ n$？  

现在我们钦定存在$x$满足次递推式。（也就是$a_ n$可以被用$x^ n$表示出来）  
那么会有$x^ n=x^ {n-1}+x^ {n-2}$  
这时候线性的用处就体现出来了。  
$x^2=x+1$  
这时候就有了两个解。  
虽然转移一样，可是两个解的$x^1$项与$a_ 1$并不相同。  
这里就可以把$a_ 1$看作是$k_1x_ 1+k_ 2x_ 2$。  
根据定义会有：
$$a_ n=k_ 1x_ 1^n+k_ 2x_ 2^n=k_ 1(x_ 1^{n-1}+x_ 1^{n-2})+k_ 2(x_ 2^{n-1}+x_ 2^{n-2})=a_ {n-1}+a_ {n-2}$$
这样的话，我们就可以去随意构造一个递推的表示了。  
也可以把一个符合性质的数列第n项转化成第0项和第1项乘上系数之后的和。  
假如说现在的递推式变成了$a_ n=\sum_ {i=1}^ {k}c_ ia_ {n-i}$，求第$n$项呢？  
套路一样。  
根据定义，$a_ n-\sum_ {i=1}^ {k}c_ ia_ {n-i}=0$  
我们可以把$a_ i(i>=k)$不停地往下递归，最后会得到一个$k+1$项式。  
这样只要$k$不太大就能解决这个问题了。  
中途代入的时候可以用快速幂+FFT  

### Hamilton-Cayley theorem

对于一个矩阵$t$，他有一个特征多项式F()。  
但这个特征多项式不一定要带入一个值，它可以代入一个矩阵。  
定理：$F(t)=0$(0矩阵)  
不会证明。  
一个使用：  
定义一个向量$v$  
会有$vF(t)=0$(0向量)  
既然都是0了，那多乘几个t也不会影响。  
$vF(t)t^n=0$
用分配律把向量$v$展开  
会有$\sum i p_ i v_ i=0$  
哎好像和某递推式有点像？




